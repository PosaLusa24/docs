<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Check for New Channels · Dark Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="It can be hard to keep up with all of the changes in your Slack workspace! This tutorial will walk you through how to build a simple tool in Dark that posts all new, public Slack channels created in your Slack workspace in the past 24 hours. "/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Check for New Channels · Dark Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://darklang.github.io/docs/"/><meta property="og:description" content="It can be hard to keep up with all of the changes in your Slack workspace! This tutorial will walk you through how to build a simple tool in Dark that posts all new, public Slack channels created in your Slack workspace in the past 24 hours. "/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/docs/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-159199190-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-159199190-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/favicon.ico" alt="Dark Documentation"/><h2 class="headerTitleWithLogo">Dark Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/introduction" target="_self">Documentation</a></li><li class=""><a href="/docs/tutorials/tutorial-intro" target="_self">Tutorials &amp; Samples</a></li><li class="siteNavGroupActive"><a href="/docs/slack-apps/slack-intro" target="_self">Building Slack Apps</a></li><li class=""><a href="/docs/contributing/getting-started" target="_self">Contributing</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Tutorials</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Slack Apps</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/slack-apps/slack-intro">Your First Slack App</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-apps/slack-oauth">Setting Up OAuth</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-apps/slack-packages">Slack Packages</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/slack-apps/tutorials/channel-check">Check for New Channels</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-apps/tutorials/asana-tutorial">Create Asana Projects &amp; Tasks</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-apps/tutorials/new-trello-card">Create a New Trello Card</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-app-tutorial">Slack tutorial</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Check for New Channels</h1></header><article><div><span><p>It can be hard to keep up with all of the changes in your Slack workspace! This tutorial will walk you through how to build a simple tool in Dark that posts all new, public Slack channels created in your Slack workspace in the past 24 hours.</p>
<p>A full sample canvas for this tutorial is available <a href="https://darklang.com/a/sample-slackchannelcheck">here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="slack-configuration"></a><a href="#slack-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Slack Configuration</h2>
<ol>
<li><a href="https://api.slack.com/apps">Create a new app in Slack</a>.</li>
<li>Navigate to <strong>Features -&gt; OAuth&amp; Permissions</strong>, scroll down to scopes and add the following bot token scopes: <code>channels:manage</code>, <code>channels:read</code>, <code>chat:write</code>, and <code>chat:write.public</code>. This will allow our app to interact with our the channels (also known as conversations) and post messages about them.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/bottokenscopes.png" alt="assets/slack-apps/tutorials/channelcheck/bottokenscopes.png"></p>
<ol start="3">
<li>Install your app to the workspace (either via <strong>Settings -&gt; Basic Information</strong> or <strong>Settings -&gt; Install App</strong>). Since this app is being built for your workspace specifically, we will not need to set up full OAuth, like we would if we wanted to distribute this more publicly.</li>
<li>Copy your bot user access token, which will now be available under <strong>Settings -&gt; Install</strong> app and save it as a function in your Dark canvas. Use this function wherever you see <code>token</code> in the code examples.</li>
<li>If no new channels have been created in your Slack recently, create a new public channel so we have some data to work with.</li>
<li>You will need to choose a Slack channel to post your messages to. You can find your Slack channel's id by navigating to the channel and looking for the 11 character string that begins with a capital C - it will look something like <code>C1234567891</code>. Add that to its own Dark function as well, and use it wherever you see <code>channel</code> in the code examples.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="building-in-dark"></a><a href="#building-in-dark" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building in Dark</h2>
<ol>
<li>Create a new daily Cron named <code>checkForNewChannels</code> by clicking the + in the sidebar next to Cron, and call the <a href="../slack-packages#getnewconversations"><code>getNewConversations</code> Slack function</a> (it's a little confusing, but channels are referred to as conversations in the Slack API). The <code>getNewConversations</code> function is built into Dark's <a href="./../../packages">package manager</a>, and it takes your token as well as an amount of time to check in Epoch seconds. Here, we're asking it to check in the past 24 hours, which is equivalent to 86400 seconds.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/checkfornewchannels.png" alt="assets/slack-apps/tutorials/channelcheck/checkfornewchannels.png"></p>
<ol start="2">
<li>Click the play button on the <a href="../slack-packages#getnewconversations"><code>getNewConversations</code> function</a> and then place your carat in <code>newChannels</code>. You will see a list of information about any new channels that have been created.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/checkfornewchannelslive.png" alt="assets/slack-apps/tutorials/channelcheck/checkfornewchannelslive.png"></p>
<ol start="3">
<li>Create a function called <code>formatChannelList</code> with a <code>channelList</code> parameter. This is where we're going to build the format of the messages Slack will print about your new channels, but for now, just return <code>channelList</code>. You'll notice that an error is shown - this is because <code>channelList</code> has not yet been set.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/firstformatchannel.png" alt="assets/slack-apps/tutorials/channelcheck/firstformatchannel.png"></p>
<ol start="4">
<li>Return to your <code>checkForNewChannels</code> Cron, and add a line to format the <code>newChannels</code> list you previously generated. Press the play button.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/checkfornewchannelslist.png" alt="assets/slack-apps/tutorials/channelcheck/checkfornewchannelslist.png"></p>
<ol start="5">
<li>Return to your <code>formatChannelList</code> function and place your carat over the top dot (trace) on the left. You will see your <code>channelList</code> trace - now you can work with that data in order to format your list.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/formatchannellist.png" alt="assets/slack-apps/tutorials/channelcheck/formatchannellist.png"></p>
<ol start="6">
<li>For our purposes, we're going to do a very simple amount of formatting - we're going to add the markdown Slack needs to make channel names links, and add information about the channel's purpose. However, lots of information about Slack channels is available. Type <code>val.</code> and scroll through the autocomplete to see all of your options.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/formatchannellistlong.png" alt="assets/slack-apps/tutorials/channelcheck/formatchanellistlong.png"></p>
<ol start="7">
<li><p>In your <code>checkForNewChannels</code> Cron, rerun <code>formatChannelList</code> to update the value of <code>formattedList</code>.</p></li>
<li><p>Add a check for the length of the list - we're going to print out something different if there have been no new channels.</p></li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/listlength.png" alt="assets/slack-apps/tutorials/channelcheck/listlength.png"></p>
<ol start="9">
<li>The full code is going to look like this - if there are entries in the list, we'll post an announcement message and then the list of new channels. You'll notice that we also use the <a href="../slack-packages#postmarkdownmessage"><code>postMarkDownMessage</code> Slack function</a> to simplify the posting of the message.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/fullcheckfornewchannels.png" alt="assets/slack-apps/tutorials/channelcheck/fullcheckfornewchannels.png"></p>
<ol start="10">
<li>To make our code a little bit cleaner, we've pulled the logic of posting the list of new channels out into a function. This function iterates through the list it is given and posts a markdown message to Slack for each entry.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/postlist.png" alt="assets/slack-apps/tutorials/channelcheck/postlist.png"></p>
<ol start="11">
<li>Once you've completed all of your code, run the Cron again. A message will appear in the channel you selected.</li>
</ol>
<p><img src="/docs/assets/slack-apps/tutorials/channelcheck/newchannelpost.png" alt="assets/slack-apps/tutorials/channelcheck/newchannelpost.png"></p>
<p>Congratulations - you now have a Slack app that will post every 24 hours with any new channels created since it last posted.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/slack-apps/slack-packages"><span class="arrow-prev">← </span><span>Slack Packages</span></a><a class="docs-next button" href="/docs/slack-apps/tutorials/asana-tutorial"><span>Create Asana Projects &amp; Tasks</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#slack-configuration">Slack Configuration</a></li><li><a href="#building-in-dark">Building in Dark</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 Dark</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '1e1c6adb6b62f53c456dc70e833c2c26',
                indexName: 'darklang',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>