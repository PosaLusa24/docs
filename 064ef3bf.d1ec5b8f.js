(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{151:function(a,t,e){"use strict";e.r(t),e.d(t,"frontMatter",(function(){return o})),e.d(t,"metadata",(function(){return l})),e.d(t,"rightToc",(function(){return i})),e.d(t,"default",(function(){return p}));var s=e(2),n=e(11),r=(e(0),e(243)),o={id:"asana-tutorial",title:"Create Asana Projects & Tasks",sidebar_label:"Create Asana Projects & Tasks"},l={id:"slack-apps/tutorials/asana-tutorial",isDocsHomePage:!1,title:"Create Asana Projects & Tasks",description:"Connecting your Asana account with your Slack account can make for a powerful tool - no more switching tabs and hunting for the right Asana project when you want to capture the excellent idea that just came up. In this tutorial, we'll show you a few ways to enable your team to create new Asana tasks directly from Slack.",source:"@site/docs/slack-apps/tutorials/asana-tutorial.md",permalink:"/docs/slack-apps/tutorials/asana-tutorial",sidebar_label:"Create Asana Projects & Tasks",sidebar:"Slack",previous:{title:"Check for New Channels",permalink:"/docs/slack-apps/tutorials/channel-check"},next:{title:"Create a New Trello Card from Slack",permalink:"/docs/slack-apps/tutorials/new-trello-card"}},i=[{value:"Asana Configuration",id:"asana-configuration",children:[]},{value:"Slack Configuration",id:"slack-configuration",children:[]},{value:"Building In Dark",id:"building-in-dark",children:[{value:"Looking Up Project &amp; Workspace IDs",id:"looking-up-project--workspace-ids",children:[]},{value:"Making input easier with modals",id:"making-input-easier-with-modals",children:[]}]}],c={rightToc:i};function p(a){var t=a.components,e=Object(n.a)(a,["components"]);return Object(r.b)("wrapper",Object(s.a)({},c,e,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Connecting your Asana account with your Slack account can make for a powerful tool - no more switching tabs and hunting for the right Asana project when you want to capture the excellent idea that just came up. In this tutorial, we'll show you a few ways to enable your team to create new Asana tasks directly from Slack."),Object(r.b)("h2",{id:"asana-configuration"},"Asana Configuration"),Object(r.b)("p",null,"For this tutorial, you'll want to grab a couple different things from Asana and store each of them as separate functions in Dark:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Your ",Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"https://app.asana.com/0/developer-console"}),"personal access token")),Object(r.b)("li",{parentName:"ul"},"The id of one of your workspaces. The easiest way to access this is via the admin panel - it will be the long number in the URL.")),Object(r.b)("h2",{id:"slack-configuration"},"Slack Configuration"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"https://api.slack.com/apps"}),"Create a new app in Slack.")),Object(r.b)("li",{parentName:"ol"},"Set a Slash command (the option should appear under ",Object(r.b)("strong",{parentName:"li"},"Add features & functionality")," on your app's main page). Your Request URL should look something like ",Object(r.b)("inlineCode",{parentName:"li"},"https://yourusername-yourcanvasname.builtwithdark.com/new-project"),". This is the URL that Slack will call when you use your slash command - don't add anything to your Dark canvas just yet.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/slashcommand.png",alt:"assets/slack-apps/tutorials/asana-tutorial/slashcommand.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Go to ",Object(r.b)("strong",{parentName:"li"},"Features -> OAuth & Permissions")," and add the following scopes to your app: ",Object(r.b)("inlineCode",{parentName:"li"},"chat:write"),", ",Object(r.b)("inlineCode",{parentName:"li"},"chat:write.public"),", ",Object(r.b)("inlineCode",{parentName:"li"},"commands."))),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/permissions.png",alt:"assets/slack-apps/tutorials/asana-tutorial/permissions.png"}))),Object(r.b)("ol",{start:4},Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Install your app to the workspace (either via\xa0",Object(r.b)("strong",{parentName:"p"},"Settings -> Basic Information"),"\xa0or\xa0",Object(r.b)("strong",{parentName:"p"},"Settings -> Install App"),"). Since this app is being built for your workspace specifically, we will not need to set up full OAuth, like we would if we wanted to distribute this more publicly.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Copy your bot user access token, which will now be available under\xa0",Object(r.b)("strong",{parentName:"p"},"Settings -> Install"),"\xa0app and save it as a function in your Dark canvas. Use this function wherever you see\xa0",Object(r.b)("inlineCode",{parentName:"p"},"slackToken"),"\xa0in the code examples."))),Object(r.b)("h2",{id:"building-in-dark"},"Building In Dark"),Object(r.b)("p",null,"First, we're going to learn how to create new Asana projects using slash commands."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Go to Slack and try to use your new slash command. Make sure to include some text after entering your command. You will see an error message appear.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/newprojecterror.png",alt:"assets/slack-apps/tutorials/asana-tutorial/newprojecterror.png"}))),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Navigate to your Dark canvas and check the 404s section in the sidebar - you should see an HTTP POST created called ",Object(r.b)("inlineCode",{parentName:"li"},"/new-project")," (or whatever you used when setting up your slash command). Click the plus sign to add it to your canvas.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/newproject404.png",alt:"assets/slack-apps/tutorials/asana-tutorial/newproject404.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Once your handler is on your canvas, you can click on the trace (the white dot to the left) to see the incoming data Slack attempted to send.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/trace.png",alt:"assets/slack-apps/tutorials/asana-tutorial/trace.png"}))),Object(r.b)("ol",{start:4},Object(r.b)("li",{parentName:"ol"},"You will see a text field in the body of the trace data. Use ",Object(r.b)("inlineCode",{parentName:"li"},"request.body.text")," to set your project name.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/projectname.png",alt:"assets/slack-apps/tutorials/asana-tutorial/projectname.png"}))),Object(r.b)("ol",{start:5},Object(r.b)("li",{parentName:"ol"},"Using the ",Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"/docs/packages#createproject"}),Object(r.b)("inlineCode",{parentName:"a"},"Asana::createProject function"))," and the data we grabbed from the trace, we can now create a new project. You will need to use the workspace id and personal access token you saved in the set-up process.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/createProject.png",alt:"assets/slack-apps/tutorials/asana-tutorial/createProject.png"}))),Object(r.b)("ol",{start:6},Object(r.b)("li",{parentName:"ol"},"Try your Slash command again and then check Asana - your new project will be there!")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/asanaproject.png",alt:"assets/slack-apps/tutorials/asana-tutorial/asanaproject.png"}))),Object(r.b)("ol",{start:7},Object(r.b)("li",{parentName:"ol"},"Now, let's try sending over a slash command with different data. Return to Slack and use your slash command again, but this time, write a project name, ",Object(r.b)("inlineCode",{parentName:"li"},"\\")," sign and a description and send it over (something like ",Object(r.b)("inlineCode",{parentName:"li"},"\\asana-new-project Another New Project/Notes on the project"),"). Return to Dark and check the traces - you should see a text field formatted like this:")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/textexample.png",alt:"assets/slack-apps/tutorials/asana-tutorial/textexample.png"}))),Object(r.b)("ol",{start:8},Object(r.b)("li",{parentName:"ol"},"Now, we can use the ",Object(r.b)("inlineCode",{parentName:"li"},"String::split")," function to separate out our two pieces of information, and add them separately to the ",Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"....%5Cpackages.md#createProject"}),Object(r.b)("inlineCode",{parentName:"a"},"Asana::createProject function"))," function.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/notes.png",alt:"assets/slack-apps/tutorials/asana-tutorial/notes.png"}))),Object(r.b)("h3",{id:"looking-up-project--workspace-ids"},"Looking Up Project & Workspace IDs"),Object(r.b)("p",null,"You're not always going to want to pre-define your workspace or projects via Dark functions. This section will show you how to take a project name as a ",Object(r.b)("inlineCode",{parentName:"p"},"String")," and get the corresponding id. We'll be using projects for this example, but it works the same way for workspaces."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Create a Projects datastore.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/projectsdatastore.png",alt:"assets/slack-apps/tutorials/asana-tutorial/projectsdatastore.png"}))),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Create a new REPL. First, use the ",Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"....%5Cpackages.md#getAllProjects"}),Object(r.b)("inlineCode",{parentName:"a"},"Asana::getAllProjects"))," function to grab information about all projects you have access to. Then, use a ",Object(r.b)("inlineCode",{parentName:"li"},"List::map")," to add their names and gids to the DB.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/populatedb.png",alt:"assets/slack-apps/tutorials/asana-tutorial/populatedb.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"To see this in action, create a fresh slash command and call it, using the task name/project name formatting. To make it easier on yourself, make sure to use a project name that already exists.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Split out the information as you did before."))),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/taskandproject.png",alt:"assets/slack-apps/tutorials/asana-tutorial/taskandproject.png"}))),Object(r.b)("ol",{start:5},Object(r.b)("li",{parentName:"ol"},"Create a new function called ",Object(r.b)("inlineCode",{parentName:"li"},"lookUpProjectID")," and then use ",Object(r.b)("inlineCode",{parentName:"li"},"DB::queryOne")," to grab the id based on the ",Object(r.b)("inlineCode",{parentName:"li"},"projectName"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/lookupprojectid.png",alt:"assets/slack-apps/tutorials/asana-tutorial/lookupprojectid.png"}))),Object(r.b)("ol",{start:6},Object(r.b)("li",{parentName:"ol"},"Use a match statement to handle both the success and failure (couldn't find the project name in the db) case.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/match.png",alt:"assets/slack-apps/tutorials/asana-tutorial/match.png"}))),Object(r.b)("ol",{start:7},Object(r.b)("li",{parentName:"ol"},"Use your new function your HTTP POST handler.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/lookupid.png",alt:"assets/slack-apps/tutorials/asana-tutorial/lookupid.png"}))),Object(r.b)("ol",{start:8},Object(r.b)("li",{parentName:"ol"},"Call the slash command again and check Asana - a new task should be there.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/newesttask.png",alt:"assets/slack-apps/tutorials/asana-tutorial/newesttask.png"}))),Object(r.b)("h3",{id:"making-input-easier-with-modals"},"Making input easier with modals"),Object(r.b)("p",null,"Okay, this is all great, but still has some problems. What if someone forgets to add the right special character? Let's make it a little easier, by creating a modal to handle their input."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Create a new slash command.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/newmodal.png",alt:"assets/slack-apps/tutorials/asana-tutorial/newmodal.png"}))),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Turn Interactivity on via ",Object(r.b)("strong",{parentName:"li"},"Features -> Interactivity and Shortcuts")," and specify a URL for the interaction to be sent to:")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/interactivity.png",alt:"assets/slack-apps/tutorials/asana-tutorial/interactivity.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Slack uses ",Object(r.b)("inlineCode",{parentName:"p"},"JSON")," to generate modals via a framework called Block Kit, even providing a ",Object(r.b)("a",Object(s.a)({parentName:"p"},{href:"https://api.slack.com/tools/block-kit-builder"}),"handy Block Kit builder"),". At this point, it may make sense to pause and create your modal - we'll need the ",Object(r.b)("inlineCode",{parentName:"p"},"JSON")," soon. The modal we're going to use has 3 fields: a single line for the task name, a multiline for the task description and a select for a list of projects.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Call your new slash command and grab the 404, as you did in previous steps.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Start by setting your ",Object(r.b)("inlineCode",{parentName:"p"},"triggerId")," using ",Object(r.b)("inlineCode",{parentName:"p"},"request.body.trigger_id"),":"))),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/triggerid.png",alt:"assets/slack-apps/tutorials/asana-tutorial/triggerid.png"}))),Object(r.b)("ol",{start:6},Object(r.b)("li",{parentName:"ol"},"Format your header - you will need the Slack token you grabbed earlier in the set-up process.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/header.png",alt:"assets/slack-apps/tutorials/asana-tutorial/header.png"}))),Object(r.b)("ol",{start:7},Object(r.b)("li",{parentName:"ol"},"Create an ",Object(r.b)("inlineCode",{parentName:"li"},"HttpClient::post")," request and add your ",Object(r.b)("inlineCode",{parentName:"li"},"triggerID")," and ",Object(r.b)("inlineCode",{parentName:"li"},"JSON"),". These are truncated screenshots with a lot of the JSON cut out:")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/json1.png",alt:"assets/slack-apps/tutorials/asana-tutorial/json1.png"}))),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/json2.png",alt:"assets/slack-apps/tutorials/asana-tutorial/json2.png"}))),Object(r.b)("ol",{start:8},Object(r.b)("li",{parentName:"ol"},"Try your new Slash command. A modal should appear. Fill in the modal and hit submit to get a new error message:")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/asanaerror.png",alt:"assets/slack-apps/tutorials/asana-tutorial/asanaerror.png"}))),Object(r.b)("ol",{start:8},Object(r.b)("li",{parentName:"ol"},"Check your 404s and add your new handler. This is the handler where the behind-the-scenes logic will happen. Start by formatting the payload into ",Object(r.b)("inlineCode",{parentName:"li"},"JSON"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/payload.png",alt:"assets/slack-apps/tutorials/asana-tutorial/payload.png"}))),Object(r.b)("ol",{start:9},Object(r.b)("li",{parentName:"ol"},"Now grab all of your important values from your modal fields:")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/payloaddata.png",alt:"assets/slack-apps/tutorials/asana-tutorial/payloaddata.png"}))),Object(r.b)("ol",{start:10},Object(r.b)("li",{parentName:"ol"},"Use the ",Object(r.b)("a",Object(s.a)({parentName:"li"},{href:"....%5Cpackages.md#createTask"}),Object(r.b)("inlineCode",{parentName:"a"},"Asana::createTask"))," and the ",Object(r.b)("inlineCode",{parentName:"li"},"lookUpProjectID")," functions to create your new task.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/createtask.png",alt:"assets/slack-apps/tutorials/asana-tutorial/createtask.png"}))),Object(r.b)("ol",{start:11},Object(r.b)("li",{parentName:"ol"},"Respond with a ",Object(r.b)("inlineCode",{parentName:"li"},"200"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/200.png",alt:"assets/slack-apps/tutorials/asana-tutorial/200.png"}))),Object(r.b)("ol",{start:12},Object(r.b)("li",{parentName:"ol"},"Check Asana - your new task should be visible in the project your specified project.")),Object(r.b)("p",null,Object(r.b)("img",Object(s.a)({parentName:"p"},{src:"assets/slack-apps/tutorials/asana-tutorial/mytask.png",alt:"assets/slack-apps/tutorials/asana-tutorial/mytask.png"}))),Object(r.b)("p",null,"Congratulations, you now have a Slack app that can create Asana projects and tasks in multiple ways!"))}p.isMDXComponent=!0},243:function(a,t,e){"use strict";e.d(t,"a",(function(){return b})),e.d(t,"b",(function(){return j}));var s=e(0),n=e.n(s);function r(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function o(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,s)}return e}function l(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?o(Object(e),!0).forEach((function(t){r(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function i(a,t){if(null==a)return{};var e,s,n=function(a,t){if(null==a)return{};var e,s,n={},r=Object.keys(a);for(s=0;s<r.length;s++)e=r[s],t.indexOf(e)>=0||(n[e]=a[e]);return n}(a,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(s=0;s<r.length;s++)e=r[s],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(n[e]=a[e])}return n}var c=n.a.createContext({}),p=function(a){var t=n.a.useContext(c),e=t;return a&&(e="function"==typeof a?a(t):l(l({},t),a)),e},b=function(a){var t=p(a.components);return n.a.createElement(c.Provider,{value:t},a.children)},u={inlineCode:"code",wrapper:function(a){var t=a.children;return n.a.createElement(n.a.Fragment,{},t)}},m=n.a.forwardRef((function(a,t){var e=a.components,s=a.mdxType,r=a.originalType,o=a.parentName,c=i(a,["components","mdxType","originalType","parentName"]),b=p(e),m=s,j=b["".concat(o,".").concat(m)]||b[m]||u[m]||r;return e?n.a.createElement(j,l(l({ref:t},c),{},{components:e})):n.a.createElement(j,l({ref:t},c))}));function j(a,t){var e=arguments,s=t&&t.mdxType;if("string"==typeof a||s){var r=e.length,o=new Array(r);o[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=a,l.mdxType="string"==typeof a?a:s,o[1]=l;for(var c=2;c<r;c++)o[c]=e[c];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,e)}m.displayName="MDXCreateElement"}}]);