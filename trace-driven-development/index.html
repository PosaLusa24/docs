<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Trace Driven Development · Dark Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Dark flows from end user experience through to the backend components. If you would like to see any of the code from this document, the sample canvas that goes along with it is: [https://darklang.com/a/sample-introtodark](https://darklang.com/a/sample-introtodark#handler=1175293748)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Trace Driven Development · Dark Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://darklang.github.io/docs/"/><meta property="og:description" content="Dark flows from end user experience through to the backend components. If you would like to see any of the code from this document, the sample canvas that goes along with it is: [https://darklang.com/a/sample-introtodark](https://darklang.com/a/sample-introtodark#handler=1175293748)"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/docs/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-159199190-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-159199190-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/favicon.ico" alt="Dark Documentation"/><h2 class="headerTitleWithLogo">Dark Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/introduction" target="_self">Documentation</a></li><li class=""><a href="/docs/tutorials/tutorial-intro" target="_self">Tutorials &amp; Samples</a></li><li class=""><a href="/docs/slack-apps/slack-intro" target="_self">Building Slack Apps</a></li><li class=""><a href="/docs/contributing/getting-started" target="_self">Contributing</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/introduction">Hello World!</a></li><li class="navListItem"><a class="navItem" href="/docs/your-first">Your First App</a></li><li class="navListItem"><a class="navItem" href="/docs/from-python">From Python</a></li><li class="navListItem"><a class="navItem" href="/docs/from-javascript">From Javascript</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Concepts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/when-dark">When to use Dark</a></li><li class="navListItem"><a class="navItem" href="/docs/dark-backend-components">Components</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/trace-driven-development">Trace Driven Development</a></li><li class="navListItem"><a class="navItem" href="/docs/structured-editing">Structured Editing</a></li><li class="navListItem"><a class="navItem" href="/docs/error-handling">Error Handling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Language</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/languageoverview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/unique-aspects">Unique Aspects</a></li><li class="navListItem"><a class="navItem" href="/docs/functional-aspects">Functional Aspects</a></li><li class="navListItem"><a class="navItem" href="/docs/languagedetails">Language Details</a></li><li class="navListItem"><a class="navItem" href="/docs/datastores">Datastores</a></li><li class="navListItem"><a class="navItem" href="/docs/packages">Packages</a></li><li class="navListItem"><a class="navItem" href="/docs/httpclient">HTTP Client</a></li><li class="navListItem"><a class="navItem" href="/docs/http">HTTP Responses</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">How to</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/static-assets">Host Static Assets</a></li><li class="navListItem"><a class="navItem" href="/docs/custom-domains">Use a Custom Domain</a></li><li class="navListItem"><a class="navItem" href="/docs/cors">CORS</a></li><li class="navListItem"><a class="navItem" href="/docs/teamwork">Work with your team</a></li><li class="navListItem"><a class="navItem" href="/docs/feature-flags">Use Feature Flags</a></li><li class="navListItem"><a class="navItem" href="/docs/writing-tests">Write Tests</a></li><li class="navListItem"><a class="navItem" href="/docs/external-infra">Connect to External Infrastructure</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/function-reference">Built-in Function reference</a></li><li class="navListItem"><a class="navItem" href="/docs/keyboard-mapping">Keyboard Mapping</a></li><li class="navListItem"><a class="navItem" href="/docs/support">Support &amp; Feedback</a></li><li class="navListItem"><a class="navItem" href="/docs/known-issues">Known issues</a></li><li class="navListItem"><a class="navItem" href="/docs/sharing-dark">Sharing Your Dark Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/changelog">Changelog</a></li><li class="navListItem"><a class="navItem" href="/docs/faqs">FAQs</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Trace Driven Development</h1></header><article><div><span><p>Dark flows from end user experience through to the backend components. If you would like to see any of the code from this document, the sample canvas that goes along with it is: <a href="https://darklang.com/a/sample-introtodark#handler=1175293748">https://darklang.com/a/sample-introtodark</a></p>
<h2><a class="anchor" aria-hidden="true" id="sending-requests-to-dark"></a><a href="#sending-requests-to-dark" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending Requests to Dark</h2>
<p>Send requests to Dark <em>before writing code</em>. There are several ways to do this:</p>
<ol>
<li>Build your frontend or mobile app first and point your API endpoints at Dark (you can host your frontend on Dark by <a href="/docs/static-assets">uploading your static assets</a> via CLI).</li>
<li>Use another platform that makes requests via REST (Slack, Twilio, Shopify) and use Dark with existing webhooks or calls.</li>
<li><strong>Use postman, curl, or another tool of your choice to send test data in the correct shape to your API endpoints.</strong> This is the easiest way to get started, and you can try it out by following the rest of this doc.</li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="using-browser--curl-for-requests"></a><a href="#using-browser--curl-for-requests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using Browser &amp; Curl for Requests</h3>
<h4><a class="anchor" aria-hidden="true" id="get-requests"></a><a href="#get-requests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GET Requests</h4>
<ul>
<li>Open your canvas (darklang.com/a/USERNAME-CANVASNAME).</li>
<li>In another tab, visit username-canvasname.builtwithdark.com/test (ex: <a href="https://sample-introtodark.builtwithdark.com/test">https://sample-introtodark.builtwithdark.com/test</a>).</li>
<li>Go back to Dark and check in the 404 section.</li>
</ul>
<p><img src="/docs/assets/trace/image9.png" alt="assets/trace/image9.png"></p>
<p>You’ll be able to create the endpoint and see the full request (including any query params if you add them - i.e. test?name=ellen). Each request shows up as a trace on the left hand side of the handler as a grey dot, or a white dot when selected.</p>
<p>You can work with the selected trace. In this case, the handler is set to return the &quot;accept&quot; field within the header. If the caret is in the text of “request” you’ll see the full request, in “headers” the full header, and in this case the caret is in &quot;accept,&quot; which means we see only that field to the left.</p>
<p>If you do not select a trace, you’ll see spinners for all live values.</p>
<p>One current limitation is that you can only write code for existing traces (trying to access something that doesn’t exist will not allow you to write the code). We’re working on it.</p>
<p><img src="/docs/assets/trace/image7.png" alt="assets/trace/image7.png"></p>
<h4><a class="anchor" aria-hidden="true" id="post-requests"></a><a href="#post-requests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>POST Requests</h4>
<p>Open terminal and curl:</p>
<pre><code class="hljs css language-shell">curl -X POST -H 'Content-Type: application/json' https://username-canvasname.builtwithdark.com/test2 -d '{"test":"test data","info":"test info"}'
</code></pre>
<p><img src="/docs/assets/trace/image11.png" alt="assets/trace/image11.png"></p>
<p><img src="/docs/assets/trace/image1.png" alt="assets/trace/image1.png"></p>
<p>When you create the route you’ll see the recent traces as white dots on the left. You can select a given trace by clicking on it and then you’ll see all expressions evaluated for that request.</p>
<p><img src="/docs/assets/trace/image12.png" alt="assets/trace/image12.png"></p>
<p>Similarly to the get request, you can work with the real data from the trace. In this case the handler shows &quot;request.body.info.&quot;</p>
<p><img src="/docs/assets/trace/image3.png" alt="assets/trace/image3.png"></p>
<p>You can select which trace you are using when evaluating your code. Below, there are three recent traces, and we’re seeing the value of “info” for the most recent.</p>
<p><img src="/docs/assets/trace/image2.png" alt="assets/trace/image2.png"></p>
<h2><a class="anchor" aria-hidden="true" id="live-values--play-buttons"></a><a href="#live-values--play-buttons" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Live Values &amp; Play Buttons</h2>
<p>Once you have requests/traces, you can use them while writing code.</p>
<p>When you write code, if you put your cursor into the code, you will always see the result of that code for the selected trace on the left hand side. These left-hand-side values are called &quot;live values.&quot;</p>
<p>As seen above with “testinfo,” expressions will automatically show you their values to the left if they have no side effects. Below, we see the result of the addition:</p>
<p><img src="/docs/assets/trace/image4.png" alt="assets/trace/image4.png"></p>
<p>When an expression does have side effects (like changing a value in a datastore or calling an external API) it will have a green “play” or “replay” button that allows the developer to <em>choose</em> to run it for the current traces.</p>
<p>In our earlier request, if we saved &quot;request.body.info&quot; to the variable &quot;request_info,&quot; we could then choose to insert it into a datastore. In this case, there’s a play button to generate a new key, and a second one to insert the information:</p>
<p><img src="/docs/assets/trace/image8.png" alt="assets/trace/image8.png"></p>
<p>Once you play the <strong>DB::generateKey</strong>, you can see the resulting key, and choose to play the <strong>DB::set</strong> expression:</p>
<p><img src="/docs/assets/trace/image10.png" alt="assets/trace/image10.png"></p>
<p>When you play <strong>DB::set</strong>, you can see the record that was inserted:</p>
<p><img src="/docs/assets/trace/image6.png" alt="assets/trace/image6.png"></p>
<h3><a class="anchor" aria-hidden="true" id="replay-entire-trace-button"></a><a href="#replay-entire-trace-button" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Replay Entire Trace Button</h3>
<p>If you wish to replay the entire trace, you can use the “replay” button next to the hamburger menu in the upper right of the handler.</p>
<p><img src="/docs/assets/trace/image14.png" alt="assets/trace/image14.png"></p>
<h2><a class="anchor" aria-hidden="true" id="return-values"></a><a href="#return-values" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Return Values</h2>
<p>When on a handler, you’ll also see a live value at the bottom that corresponds to the value a handler returns. Dark has implicit returns (more on this in <a href="functional-aspects">Functional Aspects of Dark</a>).</p>
<p><img src="/docs/assets/trace/image5.png" alt="assets/trace/image5.png"></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/dark-backend-components"><span class="arrow-prev">← </span><span>Components</span></a><a class="docs-next button" href="/docs/structured-editing"><span>Structured Editing</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#sending-requests-to-dark">Sending Requests to Dark</a><ul class="toc-headings"><li><a href="#using-browser--curl-for-requests">Using Browser &amp; Curl for Requests</a></li></ul></li><li><a href="#live-values--play-buttons">Live Values &amp; Play Buttons</a><ul class="toc-headings"><li><a href="#replay-entire-trace-button">Replay Entire Trace Button</a></li></ul></li><li><a href="#return-values">Return Values</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 Dark</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '1e1c6adb6b62f53c456dc70e833c2c26',
                indexName: 'darklang',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>