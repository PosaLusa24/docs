<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Contributor Getting started guide · Dark Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Get set up"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Contributor Getting started guide · Dark Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://darklang.github.io/docs/"/><meta property="og:description" content="# Get set up"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/docs/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-159199190-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-159199190-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/favicon.ico" alt="Dark Documentation"/><h2 class="headerTitleWithLogo">Dark Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/introduction" target="_self">Documentation</a></li><li class=""><a href="/docs/tutorials/tutorial-intro" target="_self">Tutorials &amp; Samples</a></li><li class=""><a href="/docs/slack-apps/slack-intro" target="_self">Building Slack Apps</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/docs/contributing/getting-started" target="_self">Contributing</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Contributing</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributing</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/contributing/getting-started">Contributor Getting started guide</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Contributor Getting started guide</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="get-set-up"></a><a href="#get-set-up" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get set up</h1>
<ul>
<li>Sign the CLA at <a href="https://cla-assistant.io/darklang/cla">https://cla-assistant.io/darklang/cla</a></li>
<li>Join the #contributors channel in the slack</li>
<li>Go to #contributors and ask Paul Biggar to be added to the repo</li>
<li>Follow the &quot;First contribution&quot; guide below to make your first contribution</li>
<li>Then, if you have a specific thing you'd like to build, talk to Paul Biggar
in Slack and he can help you get that shipped. If you don't have a specific
thing, Paul can help you get one.</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="set-up-the-repo"></a><a href="#set-up-the-repo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set up the repo</h1>
<p><strong><em>Reminder: Dark is proprietary software, not open source! Do not share it.</em></strong></p>
<p>Once you've been added to the repo, you'll be able to access <a href="https://github.com/darklang/dark">https://github.com/darklang/dark</a>, which is a monorepo containing the main OCaml backend, the editor (client), as well as some auxilliary services used to run the Dark infrastructure</p>
<ul>
<li>Run through the installation instructions in the README</li>
<li>Done: you can now run <code>./scripts/builder --compile --test --watch</code></li>
<li>TODO: ocamlformat</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="first-contribution"></a><a href="#first-contribution" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>First contribution</h1>
<p>Let's talk you through the first contribution. You'll write a small unit test for a built-in function. This will get you through the process of contributing and get you familiar with how to get code into Dark.</p>
<h3><a class="anchor" aria-hidden="true" id="make-the-change"></a><a href="#make-the-change" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Make the change</h3>
<p>We'll assume you have the repo set up as discussed above. Now we want to make the contribution. First, find a function which needs testing. Let's make some lists. First let's see what functions exists:</p>
<p><code>grep -hoP &quot;[A-Z][A-Za-z]+::[_a-zA-Z0-9]+&quot; backend/libexecution/ -R | sort | uniq &gt; exists</code>
And now which ones are tested</p>
<p><code>grep -hoP &quot;[A-Z][A-Za-z]+::[_a-zA-Z0-9]+&quot; backend/test -R | sort | uniq &gt; tested</code></p>
<p>Now compare them:</p>
<p><code>diff tested exists</code></p>
<p>You'll see stuff liek this (with a <code>&gt;)</code>:</p>
<pre><code class="hljs css language-ocaml"><span class="hljs-number">136</span>a169
&gt; <span class="hljs-type">List</span>::member
<span class="hljs-number">137</span>a171
&gt; <span class="hljs-type">List</span>::pushBack
<span class="hljs-number">139</span>a174,<span class="hljs-number">175</span>
&gt; <span class="hljs-type">List</span>::repeat
&gt; <span class="hljs-type">List</span>::reverse
</code></pre>
<p>OK, these functions need tests. Let's add one for <code>List::member</code>.</p>
<p>By lookong through <code>backend/test/test_other_libs.ml</code> I see that <code>t_list_stdlibs_work</code> is the right place to add this test. Any existing test looks like this:</p>
<pre><code class="hljs css language-ocaml">check_dval
  <span class="hljs-string">"List::singleton works"</span>
  (<span class="hljs-type">DList</span> [<span class="hljs-type">Dval</span>.dint <span class="hljs-number">1</span>])
  (exec_ast' (fn <span class="hljs-string">"List::singleton"</span> [<span class="hljs-built_in">int</span> <span class="hljs-number">1</span>])) ;
</code></pre>
<p>Let's go through this:</p>
<ul>
<li><code>check_dval</code> is a test that checks that it's 2nd and 3rd arguments are the same dval (a <code>dval</code> is a Dark value; every string, int, option, list, etc, are all represented as <code>dvals</code>. See <code>backend/libexecution/types.ml</code> for the definition).</li>
<li><code>(DList [Dval.dint 1])</code> is a run-time Dark value with a list containing an int. In Dark, this would be <code>[1]</code></li>
<li><code>exec_ast'</code> is a function to execute a given AST (<code>AST</code> means &quot;abstract syntax tree&quot; and is a compiler-y term for &quot;some classes that represent a program&quot;.). Note, there's also an <code>exec_ast</code> (no <code>'</code> at the end) which we are phasing out.</li>
<li>The AST being executed is a Function call to <code>List::singleton</code>, taking a single parameter, the integer <code>1</code></li>
<li>So this test checks that calling <code>List::singleton 1</code> gets you <code>[1]</code>. That seems right.</li>
</ul>
<p>Let's make one for <code>List::member</code>:</p>
<pre><code class="hljs css language-ocaml">check_dval
  <span class="hljs-string">"List::member works for empty lists"</span>
  (<span class="hljs-type">DBool</span> <span class="hljs-literal">false</span>)
  (exec_ast' (fn <span class="hljs-string">"List::member"</span> [<span class="hljs-built_in">list</span> <span class="hljs-literal">[]</span>; <span class="hljs-built_in">int</span> <span class="hljs-number">1</span>])) ;
</code></pre>
<p>So this checks whether <code>List::member [] 1</code> is <code>false</code> as we expect.</p>
<p>Add your function to <code>t_list_stdlibs_work</code> and save the file. It should automatically recompile and run the test.</p>
<p>Great, we're done!</p>
<h3><a class="anchor" aria-hidden="true" id="make-a-pull-request"></a><a href="#make-a-pull-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Make a pull request</h3>
<p>If you haven't already done so, make a fork of the Dark repo to allow you to make a PR. Go to <a href="https://github.com/darklang/dark">https://github.com/darklang/dark</a> and click <code>fork</code>. Then change your remote in your git repo:</p>
<pre><code class="hljs css language-bash">git remote rm origin
git remote add origin git@github.com:myusername/dark.git
</code></pre>
<p>Then commit and push</p>
<pre><code class="hljs css language-bash">git add backend
git commit -m <span class="hljs-string">"Add test for List::member"</span>
git push --<span class="hljs-built_in">set</span>-upstream origin first-contribution
</code></pre>
<p>Go back to github and make a pull request. Here's a good message for your pull request:</p>
<p>&quot;Hi - this is my first pull request. I noticed that List::member didn't have any tests so I added one.&quot;</p>
<p>This will do for the first PR (you can ignore the checklist), we have guidelines on how to write PRs that you can use for later PRs.</p>
<h3><a class="anchor" aria-hidden="true" id="were-done-wonderful"></a><a href="#were-done-wonderful" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>We're done, wonderful!</h3>
<h1><a class="anchor" aria-hidden="true" id="how-to-contribute"></a><a href="#how-to-contribute" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to contribute</h1>
<h2><a class="anchor" aria-hidden="true" id="picking-a-project"></a><a href="#picking-a-project" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Picking a project</h2>
<p>Dark is a project with a vision for where it is going. Unfortunately, that vision is not as documented as it could be. We'll work on that!</p>
<p>In the meantime, the best thing to align well with that vision is to be very communicative. While many projects will take drive-by contributions, we are only going to take contributions which move in the same direction we are going. So start by talking to us in #contributors, letting us know what you're thinking you need.</p>
<p>The best thing to do is something that is personally blocking you. Our main goal with opening Dark is to enable users to unblock themselves or to improve their experience. Many users have shown us long laundry lists of things that bother them - you might have one too. Bring us the list, and we'll talk about where to start.</p>
<p>If you don't have something personally blocking you, but want to contribute, we have an endless list of bugs and small features that have been asked for!</p>
<p>The important thing is to start small. Dark is nearly 100,000LOC. And we have the constraints of supporting users' production apps in a continuous delivery manner. You should aim for your first few contributions to be small and non-controversial, before trying to design a big feature or product change.</p>
<h1><a class="anchor" aria-hidden="true" id="repo-layout"></a><a href="#repo-layout" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Repo layout</h1>
<ul>
<li>.circleci - CI config file</li>
<li>./auth0-branding - has some assets for our login provider</li>
<li>./_build - build dir for OCaml (empty, this is a docker volume)</li>
<li>backend - this is the main part of our backend, written in OCaml, including the language definition and execution engine, the &quot;framework&quot; (HTTP, DB, queues, etc), the editor's HTTP API, and the execution engine which runs in the client (compiled to JS from OCaml)
<ul>
<li>bin - &quot;main&quot; files for executables</li>
<li>jsanalysis - &quot;main&quot; file for client-side analysis/execution-engine</li>
<li>libbackend - the main HTTP server, and framework functionality (HTTP, DB, queues)</li>
<li>libcommon - some utilities shared between JS- and OCaml-compiled versions of backend</li>
<li>libexecution - the Dark language, including types, the runtime, most of the standard library, and of course the execution engine</li>
<li>libservice - library with some common functionality for OCaml services (backend, queues, cron)</li>
<li>libtarget - library to support certain functions in native and JS modes. Interface only.</li>
<li>libtarget.js - JS implementation of libtarget</li>
<li>libtarget.ocaml - OCaml implementation of libtarget</li>
<li>libunshared - platform specific (native) version of libunshared, which is used to provide types to libshared</li>
<li>migrations - SQL for migrations</li>
<li>node_modules - installation dir for Esy (package manager-ish thing for OCaml)</li>
<li>serialization - definition of a binary serialization format we use to store Dark programs</li>
<li>static - static HTTP assets (icons, fonts, etc)</li>
<li>swagger - deprecated old functionality</li>
<li>templates - where the single editor HTML template is stored</li>
<li>test - all backend unit tests</li>
<li>test_appdata - serialized mocked data for integration tests</li>
</ul></li>
<li>client - the editor, and the entire frontend application that is found under <a href="http://darklang.com/a/yourcanvas">darklang.com/a/yourcanvas</a> (note, not darklang.com or the docs). Written in Bucklescript/ReasonML. All frontend functionality, except the server-side APIs used for it, are here
<ul>
<li>src/analysis - handles code related to live values - requesting from the server, storing, sending to the client-side execution engine</li>
<li>src/api - most requests to the HTTP API live here</li>
<li>src/app - importat scaffolding for the application (settings, exception tracking, Main.ml)</li>
<li>src/canvas - misc files pertaining to layout</li>
<li>src/components - a number of parts of Dark have been componentized. They live here.</li>
<li>src/core - all the frontend types are defined here, also JSON  encoders and decoders for them</li>
<li>src/fluid - fluid is the &quot;editing&quot; portion of the editor, the thing you type code in. All editing of Dark code happens in here</li>
<li>src/forms - the &quot;forms&quot; editor, used for editing any form-like boxes (HTTP handler headings, DB fields, etc). Still recovering from when it was also how we wrote Dark code</li>
<li>src/package -the Dark package manager</li>
<li>src/prelude - builtin functions that are available in most other files (which start with <code>open Prelude</code>)</li>
<li>src/toplevels - HTTP handler, workers, REPLs, DBs, functions, etc, are all &quot;toplevels&quot;</li>
<li>src/util - generic utility code</li>
<li>static - some assets</li>
<li>styles - CSS</li>
<li>test - unit tests</li>
<li>workers - web workers used for analysis and fetching data from the server in the background</li>
</ul></li>
<li>config - a set of env vars for each environment. You'll be interested in the <code>dev</code> environment</li>
<li>docs - sporadic documentation</li>
<li>docs/production - documentation about how we run the Dark service</li>
<li>integration-tests - integration tests, written in JS using testcafe. Flaky and brittle. Help welcome!</li>
<li>lib - build directory used by Bucklescript</li>
<li>libshared - a small set of types that are shared between the backend and client. New and in-progress.</li>
<li>node_modules - installation dir for <code>npm</code></li>
<li>postgres-honeytail - a backend service used to send postgres logs to honeycomb (our observability vendor). The only Go in our repo.</li>
<li>queue-scheduler - a Rust backend service that runs our queues.</li>
<li>rundir - anything that runs and stores something stores it here
<ul>
<li>integration_test_logs</li>
<li>logs - logs from running services, especially server.log (backend)</li>
<li>screenshots - for integration tests</li>
<li>videos - for integration tests</li>
</ul></li>
<li>stroller - a Rust backend service that sits next to our OCaml backend. When the OCaml backend sends data to Pusher (websockets vendor) or Rollbar (exception tracking), it sends it to Stroller to send to the vendor instead. This allows execution to continue running immediately (our backend does not have efficient concurrency, so this is a hack to allow it)</li>
<li>scripts - bash scripts to do common (and sometimes uncommon and therefore forgettable) actions on the repo. Using scripts is very very common.</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="important-coding-techniques"></a><a href="#important-coding-techniques" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Important coding techniques</h1>
<h2><a class="anchor" aria-hidden="true" id="debugging"></a><a href="#debugging" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging:</h2>
<h3><a class="anchor" aria-hidden="true" id="log-statements"></a><a href="#log-statements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Log statements</h3>
<p>Both the frontend and backend have simple log statements, which return <code>()</code>.</p>
<ul>
<li>Frontend (prints in the browser console): <code>Js.log2 &quot;my message&quot; anyValue</code></li>
<li>Backend (print in rundir/logs/server.log in purple; search for <em>&quot;INSPECT&quot;</em>): <code>Log.inspecT &quot;my message&quot; any_value</code></li>
</ul>
<p>If you have existing code like this:</p>
<pre><code class="hljs css language-ocaml"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span> <span class="hljs-keyword">in</span>
<span class="hljs-keyword">let</span> y = <span class="hljs-number">6</span> <span class="hljs-keyword">in</span>
x + y
</code></pre>
<p>You can add log statements like so:</p>
<pre><code class="hljs css language-ocaml"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span> <span class="hljs-keyword">in</span>
<span class="hljs-type">Log</span>.inspecT <span class="hljs-string">"my message"</span> x; <span class="hljs-comment">(* or Js.log2, in the client)
let y = 6 in
x + y
</span></code></pre>
<h1><a class="anchor" aria-hidden="true" id="example-contributions"></a><a href="#example-contributions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example contributions</h1>
<h2><a class="anchor" aria-hidden="true" id="adding-a-test"></a><a href="#adding-a-test" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a test</h2>
<p>See <strong>First contribution</strong> above.</p>
<h2><a class="anchor" aria-hidden="true" id="adding-a-function-to-the-query-compiler"></a><a href="#adding-a-function-to-the-query-compiler" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a function to the query compiler</h2>
<p>Dark supports a subset of functions to be used in the query compiler. Those functions can be seen by reading the source in backend/libbackend/sql_compiler. To add new functions, look at binop_to_sql - those are functions that map directly from Dark's builtin types and standard library to Postgres 9.6's builtins. Functions which are easy to add will also have a direct mapping.</p>
<p>More complex functions need to be handled in lambda_to_sql directly.</p>
<p>Query compiler functions should all be tested. They have pretty good tests of basic functionality, but could do with more tests. If you want to start small, adding a test for an existing function is very welcome.</p>
<h2><a class="anchor" aria-hidden="true" id="adding-a-standard-library-function"></a><a href="#adding-a-standard-library-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a standard library function</h2>
<p>It's pretty easy to add functions to Dark's standard library. Not all functions should be added though, if it's dealing with a third party API for instance, that should be added in the package manager (coming soon).</p>
<p>Good candidates to be added in the standard library are functions which:</p>
<ul>
<li>are standard. If they feel like they belong in the List, String, Int, Float, Result, Option, UUID, Date, Dict, Bool, Bytes, DB, HTTPClient or HTTP (response) modules, they're welcome. We're interested in a broad set of functions here, so</li>
<li>provide cryptographic functions: these are hard and slow to do in userspace. We wrap several OCaml libraries to provide our Crypto functions, and in one case a rust library. We want to expand our ability to support calling HTTP APIs, so any functions which support this are welcome</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="helping-an-initiative"></a><a href="#helping-an-initiative" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Helping an initiative</h2>
<p>We are in the midst of converting from several old ways of doing things to new ways of doing things. This process can be helped by small, straightforward contributions. These are especially good for a first-time contributor, especially one just learning OCaml. One example:</p>
<h3><a class="anchor" aria-hidden="true" id="converting-from-old-ast-tests-to-new-ast-tests"></a><a href="#converting-from-old-ast-tests-to-new-ast-tests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting from old AST tests to new AST tests</h3>
<p>All of our original language tests were written like this:</p>
<pre><code class="hljs css language-ocaml"><span class="hljs-keyword">let</span> t_string_trim_noop <span class="hljs-literal">()</span> =
  check_dval
    <span class="hljs-string">"stringTrimNoop"</span>
    (exec_ast <span class="hljs-string">"(String::trim 'foo')"</span>)
    (<span class="hljs-type">Dval</span>.dstr_of_string_exn <span class="hljs-string">"foo"</span>)
</code></pre>
<p>See the <code>exec_ast</code> call which reads that Lisp-y string? I thought I was clever, but that got really hard once it got to 2 or 3 lines.</p>
<p>Now we write these tests like this:</p>
<pre><code class="hljs css language-ocaml"><span class="hljs-keyword">let</span> t_string_trim_noop <span class="hljs-literal">()</span> =
  check_dval
    <span class="hljs-string">"stringTrimNoop"</span>
    (exec_ast' (fn <span class="hljs-string">"String::trim"</span> [str <span class="hljs-string">"foo"</span>]))
    (<span class="hljs-type">Dval</span>.dstr_of_string_exn <span class="hljs-string">"foo"</span>)
</code></pre>
<p>There are 263 tests that are written the new way, and 162 written the old way. Converting some to the new way would be very helpful</p>
<h3><a class="anchor" aria-hidden="true" id="convert-from-yarn-to-npm"></a><a href="#convert-from-yarn-to-npm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Convert from yarn to npm</h3>
<p>We started with yarn, but we get confused as some of our repos use <code>npm</code>, so we've decided to standardize on <code>npm</code>. Sadly, a few scripts rely on the yarn format, and there are yarn lock files. Quite a simple project to start though, esp for the Node/scripting inclined. Grep for <code>yarn</code> to get started.</p>
<h3><a class="anchor" aria-hidden="true" id="stabilize-integration-tests"></a><a href="#stabilize-integration-tests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Stabilize integration tests</h3>
<p>Our integration tests (./integration_tests) are written in test cafe. They are quite slow and reasonably flaky, and we have found that testcafe's technology does not let us test interesting parts of our code. Some ideas here:</p>
<ul>
<li>we are interested in potentially converting from testcafe to playwright. Doing a technical evaluation (converting 1 test perhaps) to start our conversion would be useful</li>
<li>We are also interested in speeding these tests up and making them more reliable. We have not really looked at speed yet, we periodically look at reliability.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="changes-to-avoid"></a><a href="#changes-to-avoid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Changes to avoid</h2>
<ul>
<li>Never change an existing function. Make a new one (with a new version) and deprecate the old one. It is however safe to fix the types on an existing function, or to change it's docstring.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="writing-a-successful-pull-request-message"></a><a href="#writing-a-successful-pull-request-message" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Writing a successful Pull Request message</h2>
<p>When writing a pull request, there are some steps you can take to make it easier to accept the contribution:</p>
<ul>
<li>explain the problem you're solving. If this is explained elsewhere, link to it</li>
<li>explain how your solution addresses the problem</li>
<li>highlight any choices you've made in the implementation</li>
<li>make clear what the product and user-facing changes are, especially if it could break anything for existing users</li>
<li>if the change is in the editor, include a before/after screenshot or gif</li>
</ul>
<p>Highlighting these will make it much easier to know that this code is safe.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#picking-a-project">Picking a project</a></li><li><a href="#debugging">Debugging:</a><ul class="toc-headings"><li><a href="#log-statements">Log statements</a></li></ul></li><li><a href="#adding-a-test">Adding a test</a></li><li><a href="#adding-a-function-to-the-query-compiler">Adding a function to the query compiler</a></li><li><a href="#adding-a-standard-library-function">Adding a standard library function</a></li><li><a href="#helping-an-initiative">Helping an initiative</a><ul class="toc-headings"><li><a href="#converting-from-old-ast-tests-to-new-ast-tests">Converting from old AST tests to new AST tests</a></li><li><a href="#convert-from-yarn-to-npm">Convert from yarn to npm</a></li><li><a href="#stabilize-integration-tests">Stabilize integration tests</a></li></ul></li><li><a href="#changes-to-avoid">Changes to avoid</a></li><li><a href="#writing-a-successful-pull-request-message">Writing a successful Pull Request message</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 Dark</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '1e1c6adb6b62f53c456dc70e833c2c26',
                indexName: 'darklang',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>